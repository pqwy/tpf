<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Generic (tpf.Tpf.Generic)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">tpf</a> &#x00BB; <a href="../index.html">Tpf</a> &#x00BB; Generic</nav><h1>Module <code>Tpf.Generic</code></h1><p>Interface between the outside world and a <code>spine</code>.</p><p>It contains only three necessary symbols:</p><ul><li><em>users</em> need <code>p</code> and <code>!</code>, to inject from <code>'a Q.q</code> to <code>('a, p) app</code>; while</li><li><em>implementors</em> need <code>p</code> and <code>!:</code>, to project from <code>('a, p) app</code> to <code>'a Q.q</code>.</li></ul><p>The rest of this module is provided for the implementor's convenience.</p><p>Minimal complete interface to a generic function consists of <code>p</code>, <code>!</code>, and a function that looks like one of</p><pre><code class="ml">val f: ('a, p) view -&gt; ... -&gt; 'a -&gt; ...
val g: ('a, p) schema -&gt; ...</code></pre><p>A more complete interface adds a family of functions like</p><pre><code class="ml">val f0 : 'x data0 -&gt; ...
val f1 : ('a, 'x) data1 -&gt; 'a Q.q -&gt; ...
val f2 : ('a, 'b, 'x) data2 -&gt; 'a Q.q -&gt; 'b Q.q -&gt; ...
...</code></pre><p>These can be</p><ul><li>produced with the <a href="View/index.html"><code>View</code></a> and <a href="Schema/index.html"><code>Schema</code></a> functors, which have pre-canned module types, but fixed names; or</li><li>constructed manually, perhaps by using the functions <a href="index.html#val-app0"><span><code>app[n]</code></span></a>, with their signature spelled out by hand.</li></ul></header><h3 class="heading">Parameters</h3><ul><li><code><a href="argument-1-Q/index.html">Q</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></li></ul><h3 class="heading">Signature</h3><dl><dt class="spec type" id="type-q"><a href="#type-q" class="anchor"></a><code><span class="keyword">type</span> 'a q</code><code> = <span class="type-var">'a</span> <a href="argument-1-Q/index.html#type-q">Q.q</a></code></dt><dd><p>Query type for this (group of) function(s). It gives the action to be done for each constructor argument.</p></dd></dl><dl><dt class="spec type" id="type-p"><a href="#type-p" class="anchor"></a><code><span class="keyword">type</span> p</code></dt><dd><p>Proxy representing <code>Q.q</code>.</p><p><code>p</code>s exists only to embed <code>'a Q.q</code> in a <code>spine</code>.</p><p>The only possible operations involving <code>p</code> are the two below.</p></dd></dl><dl><dt class="spec external" id="val-(!)"><a href="#val-(!)" class="anchor"></a><code><span class="keyword">val</span> (!) : <span class="type-var">'a</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <a href="index.html#type-p">p</a>) <a href="../index.html#type-app">app</a></code></dt><dd><p><code>!x</code> injects into the proxy.</p></dd></dl><dl><dt class="spec external" id="val-(!:)"><a href="#val-(!:)" class="anchor"></a><code><span class="keyword">val</span> (!:) : (<span class="type-var">'a</span>, <a href="index.html#type-p">p</a>) <a href="../index.html#type-app">app</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-q">q</a></code></dt><dd><p><code>!:x</code> projects from the proxy.</p></dd></dl><dl><dt class="spec module" id="module-P"><a href="#module-P" class="anchor"></a><code><span class="keyword">module</span> <a href="P/index.html">P</a> : <a href="../index.html#module-type-P">P</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../module-type-P/index.html#type-p">p</a> = <a href="index.html#type-p">p</a> <span class="keyword">and</span> <span class="keyword">type</span> 'a <a href="../module-type-P/index.html#type-q">q</a> := <span class="type-var">'a</span> <a href="argument-1-Q/index.html#type-q">Q.q</a></code></dt><dd><p>Groups <a href="index.html#type-p"><code>p</code></a> and <a href="index.html#val-(!)"><code>(!)</code></a>, above, for easy export.</p></dd></dl><aside><p>Functors generating a <code>data[n]</code> interface.</p><p><b>Note.</b> They <em>do not include</em> types <code>q</code> and <code>r</code> from <a href="../module-type-Data/index.html"><code>Data</code></a>; when describing their output type in signatures using <a href="../module-type-Data/index.html"><code>Data</code></a>, you must eliminate <code>q</code> and <code>r</code>.</p></aside><dl><dt class="spec module" id="module-View"><a href="#module-View" class="anchor"></a><code><span class="keyword">module</span> <a href="View/index.html">View</a> : <span class="keyword">functor</span> (<a href="View/argument-1-F/index.html">F</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span>) <span>&#45;&gt;</span> <a href="../index.html#module-type-Data">Data</a> <span class="keyword">with</span> <span class="keyword">type</span> 'a <a href="View/index.html#type-q">q</a> := <span class="type-var">'a</span> <a href="argument-1-Q/index.html#type-q">Q.q</a> <span class="keyword">and</span> <span class="keyword">type</span> 'a <a href="View/index.html#type-r">r</a> := <span class="type-var">'a</span> <a href="View/argument-1-F/index.html#type-r">F.r</a></code></dt><dd><p><code>View</code> equips a generic consumer <code>gfun</code> with the <a href="../index.html#data"><span><code>data[n]</code></span></a> interface, for easy export.</p></dd></dl><dl><dt class="spec module" id="module-Schema"><a href="#module-Schema" class="anchor"></a><code><span class="keyword">module</span> <a href="Schema/index.html">Schema</a> : <span class="keyword">functor</span> (<a href="Schema/argument-1-F/index.html">F</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span>) <span>&#45;&gt;</span> <a href="../index.html#module-type-Data">Data</a> <span class="keyword">with</span> <span class="keyword">type</span> 'a <a href="Schema/index.html#type-q">q</a> := <span class="type-var">'a</span> <a href="argument-1-Q/index.html#type-q">Q.q</a> <span class="keyword">and</span> <span class="keyword">type</span> 'a <a href="Schema/index.html#type-r">r</a> := <span class="type-var">'a</span> <a href="Schema/argument-1-F/index.html#type-r">F.r</a></code></dt><dd><p><code>Schema</code> equips a generic producer <code>gfun</code> the the <a href="../index.html#data"><span><code>data[n]</code></span></a> interface, for easy export.</p></dd></dl><aside><p>Helpers for manually exporting generic functions.</p><p><code>app[n] k f</code> converts <code>f: ('a, p) app -&gt; ...</code> into <a href="index.html#type-q"><span><code>'a q -&gt; ...</code></span></a> and applies <code>k</code> to it.</p><p>For instance, <a href="View/index.html"><code>View</code></a> is given by</p><pre><code class="ml">let data0 (d: _ data0) = app0 gfun d.view
let data1 (d: _ data1) = app1 gfun d.view
...</code></pre></aside><dl><dt class="spec value" id="val-app0"><a href="#val-app0" class="anchor"></a><code><span class="keyword">val</span> app0 : (<span class="type-var">'cont</span> <span>&#45;&gt;</span> <span class="type-var">'res</span>) <span>&#45;&gt;</span> (<a href="index.html#type-p">p</a>, <span class="type-var">'cont</span>) <a href="../index.html#type-app0">app0</a> <span>&#45;&gt;</span> <span class="type-var">'res</span></code></dt><dt class="spec value" id="val-app1"><a href="#val-app1" class="anchor"></a><code><span class="keyword">val</span> app1 : (<span class="type-var">'cont</span> <span>&#45;&gt;</span> <span class="type-var">'res</span>) <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <a href="index.html#type-p">p</a>, <span class="type-var">'cont</span>) <a href="../index.html#type-app1">app1</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'res</span></code></dt><dt class="spec value" id="val-app2"><a href="#val-app2" class="anchor"></a><code><span class="keyword">val</span> app2 : (<span class="type-var">'cont</span> <span>&#45;&gt;</span> <span class="type-var">'res</span>) <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>, <a href="index.html#type-p">p</a>, <span class="type-var">'cont</span>) <a href="../index.html#type-app2">app2</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'res</span></code></dt><dt class="spec value" id="val-app3"><a href="#val-app3" class="anchor"></a><code><span class="keyword">val</span> app3 : (<span class="type-var">'cont</span> <span>&#45;&gt;</span> <span class="type-var">'res</span>) <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span>, <a href="index.html#type-p">p</a>, <span class="type-var">'cont</span>) <a href="../index.html#type-app3">app3</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'res</span></code></dt><dt class="spec value" id="val-app4"><a href="#val-app4" class="anchor"></a><code><span class="keyword">val</span> app4 : (<span class="type-var">'cont</span> <span>&#45;&gt;</span> <span class="type-var">'res</span>) <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span>, <span class="type-var">'d</span>, <a href="index.html#type-p">p</a>, <span class="type-var">'cont</span>) <a href="../index.html#type-app4">app4</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'d</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'res</span></code></dt><dt class="spec value" id="val-app5"><a href="#val-app5" class="anchor"></a><code><span class="keyword">val</span> app5 : (<span class="type-var">'cont</span> <span>&#45;&gt;</span> <span class="type-var">'res</span>) <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span>, <a href="index.html#type-p">p</a>, <span class="type-var">'cont</span>) <a href="../index.html#type-app5">app5</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'d</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'e</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'res</span></code></dt><dt class="spec value" id="val-app6"><a href="#val-app6" class="anchor"></a><code><span class="keyword">val</span> app6 : (<span class="type-var">'cont</span> <span>&#45;&gt;</span> <span class="type-var">'res</span>) <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span>, <span class="type-var">'f</span>, <a href="index.html#type-p">p</a>, <span class="type-var">'cont</span>) <a href="../index.html#type-app6">app6</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'d</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'e</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'f</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'res</span></code></dt><dt class="spec value" id="val-app7"><a href="#val-app7" class="anchor"></a><code><span class="keyword">val</span> app7 : (<span class="type-var">'cont</span> <span>&#45;&gt;</span> <span class="type-var">'res</span>) <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span>, <span class="type-var">'f</span>, <span class="type-var">'g</span>, <a href="index.html#type-p">p</a>, <span class="type-var">'cont</span>) <a href="../index.html#type-app7">app7</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'d</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'e</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'f</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'g</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'res</span></code></dt><dt class="spec value" id="val-app8"><a href="#val-app8" class="anchor"></a><code><span class="keyword">val</span> app8 : (<span class="type-var">'cont</span> <span>&#45;&gt;</span> <span class="type-var">'res</span>) <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span>, <span class="type-var">'f</span>, <span class="type-var">'g</span>, <span class="type-var">'h</span>, <a href="index.html#type-p">p</a>, <span class="type-var">'cont</span>) <a href="../index.html#type-app8">app8</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'d</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'e</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'f</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'g</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'h</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'res</span></code></dt><dt class="spec value" id="val-app9"><a href="#val-app9" class="anchor"></a><code><span class="keyword">val</span> app9 : (<span class="type-var">'cont</span> <span>&#45;&gt;</span> <span class="type-var">'res</span>) <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span>, <span class="type-var">'f</span>, <span class="type-var">'g</span>, <span class="type-var">'h</span>, <span class="type-var">'i</span>, <a href="index.html#type-p">p</a>, <span class="type-var">'cont</span>) <a href="../index.html#type-app9">app9</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'d</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'e</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'f</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'g</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'h</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'i</span> <a href="index.html#type-q">q</a> <span>&#45;&gt;</span> <span class="type-var">'res</span></code></dt></dl></div></body></html>